<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf8">
  <title>File Server</title>
  <style>
  .not_alpha {
    background-color: #ffaaaa;
    color: #ffffff;
    font-size: 10pt;
    font-weight: bold;
  }
  table {
    font-size: 10pt;
  }
  .in_dict {
    background-color: #FFA0A0;
    color: #5F0000;
    cursor: pointer;
  }
  .not_in_dict {
    background-color: #A0FFA0;
    color: #005F00;
    cursor: pointer;
  }
  </style>
  <script>
    function add_word(el, word_index) {
      var word = top.wordgroups[word_index].word;
      dict_ajax(
        "action=add&word=" + encodeURIComponent(word),
        add_word_proc,
        { "el": el, "word_index": word_index });
    }
    function add_word_proc(obj) {
      obj.el.innerHTML = "del";
      obj.el.className = "in_dict";
      obj.el.setAttribute("onclick",
        "del_word(this, " + obj.word_index + ")");
      top.wordgroups[obj.word_index].in_dict = true;
    }
    function del_word(el, word_index) {
      var word = top.wordgroups[word_index].word;
      dict_ajax(
        "action=delete&word=" + encodeURIComponent(word),
        del_word_proc,
        { "el": el, "word_index": word_index });
    }
    function del_word_proc(obj) {
      obj.el.innerHTML = "add";
      obj.el.className = "not_in_dict";
      obj.el.setAttribute("onclick",
        "add_word(this, " + obj.word_index + ")");
      top.wordgroups[obj.word_index].in_dict = false;
    }
    function dict_ajax(query, proc, obj) {
      var req = new XMLHttpRequest();
      if (!req) {
        return ;
      }
      req.onreadystatechange = function () {
        if (req.readyState == 4 && req.status == 200) {
          var resp = req.responseText;
          if (resp != "ok") {
            alert("fail");
            return;
          }
          proc(obj);
        }
      }
      req.open("POST", "/dictionary_add", true);
      req.send(query);
    }
    function form_load() {
      var html = "<table>";
      for (var i = 0; i < top.wordgroups.length; ++i) {
        var add_to_dict;

        if (top.wordgroups[i].in_dict) {
          add_to_dict =
            "<td id=\"td" + i + "\" class=\"in_dict\" onclick=\"del_word(this, " + i + ")\">" +
            "del" +
            "</td>";
        }
        else {
          add_to_dict =
            "<td id=\"td" + i + "\" class=\"not_in_dict\" onclick=\"add_word(this, " + i + ")\">" +
            "add" +
            "</td>";
        }

        html +=
          "<tr>\n" +
          "<td onclick=\"top.select_group(" + i + ")\">" + top.wordgroups[i].word + "</td>\n" +
          "<td>" + top.wordgroups[i].count + "</td>\n" +
          add_to_dict + "\n" +
          "</tr>\n";
      }
      html += "</table>";
      document.body.innerHTML = html;
    }
  </script>
</head>
<body onload="form_load()">
</body>
</html>

<!-- vim: set expandtab ts=2 : //-->
