<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf8">
  <title>File Server</title>
  <style>
  .not_alpha {
    background-color: #ffaaaa;
    color: #ffffff;
    font-size: 10pt;
    font-weight: bold;
  }
  table {
    font-size: 10pt;
  }
  .in_dict {
    background-color: #FFA0A0;
    color: #5F0000;
    cursor: pointer;
  }
  .not_in_dict {
    background-color: #A0FFA0;
    color: #005F00;
    cursor: pointer;
  }
  .group_not_selected {
    background-color: #FFFFFF;
    cursor: pointer;
  }
  .group_not_selected:hover {
    background-color: #DFFFDF;
    cursor: pointer;
  }
  .group_selected {
    background-color: #CCFFCC;
    cursor: pointer;
  }
  </style>
  <script>
    function add_del_word(el, word_index) {
      var action = "";

      if (top.wordgroups[word_index].in_dict) {
        action = "delete";
      }
      else {
        action = "add";
      }

      var word = top.wordgroups[word_index].word;

      dict_ajax(
        "action=" + action + "&word=" + encodeURIComponent(word),
        add_del_word_proc,
        { "el": el, "word_index": word_index });
    }
    function add_del_word_proc(obj) {
      if (top.wordgroups[obj.word_index].in_dict) {
        obj.el.innerHTML = "add";
        obj.el.className = "not_in_dict";
        top.wordgroups[obj.word_index].in_dict = false;
      }
      else {
        obj.el.innerHTML = "del";
        obj.el.className = "in_dict";
        top.wordgroups[obj.word_index].in_dict = true;
      }
    }
    function dict_ajax(query, proc, obj) {
      var req = new XMLHttpRequest();
      if (!req) {
        return ;
      }
      req.onreadystatechange = function () {
        if (req.readyState == 4 && req.status == 200) {
          var resp = req.responseText;
          if (resp != "ok") {
            alert("fail");
            return;
          }
          proc(obj);
        }
      }
      req.open("POST", "/dictionary", true);
      req.send(query);
    }
    function form_load() {
      var html = "<table>";
      for (var i = 0; i < top.wordgroups.length; ++i) {
        var add_to_dict;
        var class_name = "", text = "";

        if (top.wordgroups[i].in_dict) {
          class_name = "in_dict";
          text = "del";
        }
        else {
          class_name = "not_in_dict";
          text = "add";
        }

        add_to_dict =
          "<td id=\"td" + i + "\" class=\"" + class_name +
          "\" onclick=\"add_del_word(this, " + i + ")\">" +
          text +
          "</td>";

        html +=
          "<tr id=\"tr" + i + "\" class=\"group_not_selected\">\n" +
          "<td onclick=\"top.select_group(" + i + ", false)\">" + top.wordgroups[i].word + "</td>\n" +
          "<td>" + top.wordgroups[i].count + "</td>\n" +
          add_to_dict + "\n" +
          "</tr>\n";
      }
      html += "</table>";
      document.body.innerHTML = html;
    }
  </script>
</head>
<body onload="form_load()">
</body>
</html>

<!-- vim: set expandtab ts=2 : //-->
